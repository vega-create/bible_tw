---
// é¦–é 
import BaseLayout from '../layouts/BaseLayout.astro';
import { siteConfig } from '../../site.config';
import { getCollection } from 'astro:content';

// å–å¾—æœ€æ–°æ–‡ç« 
const allPosts = await getCollection('posts');
const now = new Date();
const recentPosts = allPosts
  .filter(post => !post.data.draft && new Date(post.data.publishDate) <= now)
  .sort((a, b) => new Date(b.data.publishDate).getTime() - new Date(a.data.publishDate).getTime())
  .slice(0, 6);
---

<BaseLayout>
  <!-- Hero Section -->
  <section class="bg-gradient-to-br from-amber-50 to-orange-100 py-16 md:py-24">
    <div class="max-w-4xl mx-auto px-4 text-center">
      <h1 class="text-3xl md:text-5xl font-bold text-gray-800 mb-6">
        {siteConfig.name}
      </h1>
      <p class="text-lg md:text-xl text-gray-600 mb-8">
        {siteConfig.description}
      </p>
      
      <!-- ä»Šæ—¥ç¶“æ–‡æŒ‰éˆ• - æ·±è‰²èƒŒæ™¯ -->
      <a 
        href="/tools/daily-verse"
        class="inline-flex items-center px-8 py-4 bg-amber-800 text-white text-lg font-semibold rounded-full hover:bg-amber-900 transition-all shadow-lg hover:shadow-xl"
      >
        <span class="mr-2">âœ¨</span>
        ä»Šå¤©ç¥è¦å°æˆ‘èªªä»€éº¼ï¼Ÿ
      </a>
    </div>
  </section>
  
  <!-- åˆ†é¡å€å¡Š -->
  <section class="py-12 md:py-16 bg-white">
    <div class="max-w-6xl mx-auto px-4">
      <h2 class="text-2xl font-bold text-gray-800 mb-8 text-center">æ¢ç´¢å…§å®¹</h2>
      
      <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
        {siteConfig.categories.map((category, index) => {
          const icons = ['ğŸ“–', 'ğŸ“š', 'â“'];
          const colors = [
            'bg-amber-50 border-amber-200 hover:border-amber-400 hover:bg-amber-100',
            'bg-blue-50 border-blue-200 hover:border-blue-400 hover:bg-blue-100',
            'bg-purple-50 border-purple-200 hover:border-purple-400 hover:bg-purple-100',
          ];
          return (
            <a 
              href={`/category/${category.slug}`}
              class={`block p-6 rounded-xl border-2 transition-all duration-300 transform hover:-translate-y-1 hover:shadow-lg ${colors[index % 3]}`}
            >
              <div class="text-4xl mb-4">{icons[index % 3]}</div>
              <h3 class="text-xl font-bold text-gray-800 mb-2">{category.name}</h3>
              <p class="text-gray-600">{category.description}</p>
              <div class="mt-4 text-primary font-medium text-sm">
                æŸ¥çœ‹æ–‡ç«  â†’
              </div>
            </a>
          );
        })}
      </div>
    </div>
  </section>
  
  <!-- å¿«é€Ÿå·¥å…· -->
  <section class="py-12 bg-gray-50">
    <div class="max-w-6xl mx-auto px-4">
      <div class="bg-gradient-to-r from-amber-700 to-amber-800 rounded-2xl p-8 md:p-12 text-center text-white">
        <h2 class="text-2xl md:text-3xl font-bold mb-4">ğŸ™ ä»Šæ—¥ç¶“æ–‡</h2>
        <p class="text-amber-100 mb-6">æ¯å¤©ä¸€ç¯€ç¶“æ–‡ï¼Œè†è½ç¥å°ä½ èªªçš„è©±</p>
        <a 
          href="/tools/daily-verse"
          class="inline-flex items-center px-6 py-3 bg-white text-amber-800 font-semibold rounded-full hover:bg-amber-50 transition-all"
        >
          ç«‹å³é«”é©— â†’
        </a>
      </div>
    </div>
  </section>
  
  <!-- ç²¾é¸æ–‡ç«  -->
  {recentPosts.length > 0 && (
    <section class="py-12 md:py-16 bg-white">
      <div class="max-w-6xl mx-auto px-4">
        <h2 class="text-2xl font-bold text-gray-800 mb-8 text-center">æœ€æ–°æ–‡ç« </h2>
        
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
          {recentPosts.map(post => (
            <article class="bg-white rounded-xl border border-gray-200 overflow-hidden hover:shadow-lg transition-all duration-300 transform hover:-translate-y-1">
              {post.data.image && (
                <a href={`/posts/${post.slug}`}>
                  <img 
                    src={post.data.image} 
                    alt={post.data.imageAlt || post.data.title}
                    class="w-full h-48 object-cover"
                    loading="lazy"
                  />
                </a>
              )}
              <div class="p-6">
                <span class="inline-block px-3 py-1 text-xs font-medium text-primary bg-amber-100 rounded-full mb-3">
                  {siteConfig.categories.find(c => c.slug === post.data.category)?.name || post.data.category}
                </span>
                <h3 class="text-lg font-bold text-gray-800 mb-2 line-clamp-2">
                  <a href={`/posts/${post.slug}`} class="hover:text-primary transition-colors">
                    {post.data.title}
                  </a>
                </h3>
                <p class="text-gray-600 text-sm line-clamp-2 mb-4">
                  {post.data.description}
                </p>
                <div class="flex items-center justify-between">
                  <span class="text-xs text-gray-400">
                    {new Date(post.data.publishDate).toLocaleDateString('zh-TW')}
                  </span>
                  <a 
                    href={`/posts/${post.slug}`}
                    class="text-primary text-sm font-medium hover:underline"
                  >
                    é–±è®€æ›´å¤š â†’
                  </a>
                </div>
              </div>
            </article>
          ))}
        </div>
      </div>
    </section>
  )}
</BaseLayout>

<style>
  .line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
  }
</style>